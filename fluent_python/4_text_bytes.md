# 텍스트와 바이트
## 1. 문자 문제
- 문자열이란? 문자의 열
- 그렇다문 문자란?
- 현재 '문자'를 가장 잘 정의한 것은 유니코드 문자.
- 파이썬 3 str에서 가져오는 항목도 유니코드 문자
### 인코딩, 디코딩
- 인코딩(암호화): 텍스트 -> 바이트
- 디코딩(해독): 바이트 -> 텍스트
``` 
>>> s = 'cafe'
>>> len(s)
4
>>> b = s.encode('utf8')
>>> b
b'cafe'
>>> len(b)
4
>>> b.decode('utf8')
'cafe'
```
## 2. 바이트에 대한 기본 지식
- 이진 sequence에 사용되는 내장 자료형은 bytes와 bytesarray가 있다.
  - bytes: 불변형
  - bytesarray: 가변형
### 구조체와 메모리 뷰
## 3. 기본 인코더/디코더
## 4. 인코딩/디코딩 문제 이해하기
<img width="652" alt="스크린샷 2021-11-22 오후 9 40 51" src="https://user-images.githubusercontent.com/60768642/142863596-0862b6c0-4e75-4515-99e8-9a012b0739d5.png">

<img width="625" alt="스크린샷 2021-11-22 오후 9 42 15" src="https://user-images.githubusercontent.com/60768642/142863748-939c1b52-fa29-4263-9fb4-cc5da4f3d9cf.png">

### UnicodeEncodeError 처리하기
### UnicodeDecodeError 처리하기
### 예상과 달리 인코딩된 모듈을 로딩할 때 발생하는 SyntazError
### 바이트 시퀀스의 인코딩 방식을 알아내는 방법
- 바이트 시퀀스의 인코딩 방식은 알아낼 수 없다. 반드시 별도로 인코딩 정보를 가져와야 한다.
- 하지만 경험과 통계를 이용해 인코딩 방식을 추정할 수도 있고,
- 다양한 문자 인코딩을 탐지하는 Chardet(The Universal Character Encoding Detector)패키지를 사용해 알아낼 수도 있다.
### BOM: 유용한 깨진 문자
## 5. 텍스트 파일 다루기
<img width="616" alt="스크린샷 2021-11-22 오후 9 43 58" src="https://user-images.githubusercontent.com/60768642/142863969-391541a7-bf3c-4861-86c0-f9e9f310c1f5.png">

- 텍스트를 처리하는 최고의 방법은 '유니코드 샌드위치'다.
- 입력시(파일 열 때) 가능하면 빨리 bytes를 str로 변환해야 한다.
- 샌드위치에서 고기 부분은 프로그램의 비지니스 로직에 해당한다.
- 여기서는 text를 오로지 str객체로 다룬다.
- 즉, 다른 처리를 하는 도중에 인코딩이나 디코딩하면 안 된다!
- 출력시에는 가능한 늦게 str을 bytes로 인코딩한다.
- 대부분의 web framework도 이렇게 동작하고, 처리하는 동안 bytes를 다루는 일은 거의 없다.
- 장고의 경우, view는 유니코드 str만 출력하고, 장고 자체가 응답을 bytes(UTF-8로 인코딩)로 인코딩한다.

#### 파이썬 내장
> 파이썬 3는 유니코드 샌드위치 모델을 따르기 쉽게 해준다. 내장된 open() 함수는
파일을 텍스트 모드로 읽고 쓸 때 필요한 모든 인코딩과 디코딩 작업을 수행해주므로 my_file.read()에서 str 객체를 가져와 처리하고
my_file.write()에 전달하면 된다.
### 기본 인코딩 설정: 정신 나간 거 아냐?
<img width="622" alt="스크린샷 2021-11-22 오후 9 50 44" src="https://user-images.githubusercontent.com/60768642/142864826-38e16d57-9834-4110-bbe8-af576443bad7.png">
- 위 예제에서 파일을 쓸 땐 encoding지정했지만, read할 땐 지정하지 않았고, 에러가 났다.
- 항상 read할 때도 인코딩을 지정해주자.
- 지정 안해주면 시스템 default encoding을 사용하게 되고 여기서 문제가 생긴다.
- 참고로 위 예제는 windows7에서 일어난 현상이다.

> 여러 컴퓨터나 여러 상황에서 실행되어야 하는 코드는 결코 기본 인코딩에 의존하면 안된다.
기본 인코딩 방식은 컴퓨터마다, 혹은 실행할 때마다 달라질 수 있으므로 텍스트 파일을 읽을 때는 언제나 encoding 인수를
명시적으로 지정해야 한다.


<img width="614" alt="스크린샷 2021-11-22 오후 9 54 01" src="https://user-images.githubusercontent.com/60768642/142865307-fd31cc86-8a0d-499d-902b-ec428d8edcd4.png">
<img width="629" alt="스크린샷 2021-11-22 오후 9 54 04" src="https://user-images.githubusercontent.com/60768642/142865313-f4d77432-adee-4f5c-a893-2893ed532b58.png">

- 'w', 'r'로 열면 TextIOWrapper객체가, 'rb'로 열면 BufferedReader객체가 반환된다.

> 인코딩 방식을 알아내기 위해 파일 내용을 분석하는 경우가 아니라면 텍스트 파일을 이진 모드로 열지 않는 것이 좋다.
인코딩 방식을 알아낼 때도 직접 하는 것보다 Chardet 모듈을 사용하는 것이 좋다.
일반적으로 래스터 이미지 등 이진 파일을 열 때만 이진모드를 사용해야 한다.


## 6. 제대로 비교하기 위해 유니코드 정규화하기
### 케이스 폴딩
### 정규화된 텍스트 매칭을 위한 유틸리티 함수
### 극단적인 정규화: 발음 구별 기호 제거하기
## 7. 유니코드 텍스트 정렬하기
### 유니코드 대조 알고리즘을 이용한 정렬
## 8. 유니코드 데이터베이스
## 9. 이중 모드 str 및 bytes API
### 정규 표현식에서의 str과 bytes
### os 모듈 함수에서 str과 bytes
## 10. 요약
- 텍스트를 열 땐 encoding을 명시해주자!
